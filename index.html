<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fazenda Pro [DEBUG]</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Tailwind for utilities only (layout is custom CSS) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="./index.css">
</head>
<body>

    <!-- Inventory Drawer -->
    <div id="inventory-drawer" class="inventory-drawer">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-white uppercase">Invent√°rio</h2>
            <div class="flex items-center gap-4">
                 <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="auto-close-inventory-checkbox" checked class="accent-purple-500 w-4 h-4 rounded border-gray-600 bg-gray-700">
                    <span class="text-xs text-gray-400 select-none">Auto-fechar</span>
                </label>
                <button id="close-inventory-btn" class="text-gray-400 hover:text-white">&times;</button>
            </div>
        </div>
        <div id="inventory-content" class="flex-grow">
            <!-- Dynamic Content -->
        </div>
    </div>
    
    <!-- FAB -->
    <div id="inventory-fab" class="inventory-fab" title="Abrir Invent√°rio">üéí</div>

    <div class="main-layout">
        <!-- Header -->
        <header class="app-header">
            <div class="flex items-center gap-4">
                <span class="text-3xl">üë®‚Äçüåæ</span>
                <div>
                    <h1 class="font-bold text-xl tracking-tight text-white">The Farmer <span class="text-accent-primary">PRO</span></h1>
                    <p class="text-xs text-gray-500">v2.1.0 | System Ready</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button id="reset-btn" class="btn btn-secondary text-xs text-red-500 border-red-900/50 hover:bg-red-900/20" title="Apagar Progresso">üóëÔ∏è Reset</button>
                <button id="help-btn" class="btn btn-secondary text-xs text-white">üìò API Docs</button>
                <button id="tech-btn" class="btn btn-secondary text-xs border-accent-warning text-accent-warning">‚ö° Upgrades</button>
                <button id="bots-btn" class="btn btn-secondary text-xs border-blue-400 text-blue-400 hidden">ü§ñ Bots</button>
            </div>
        </header>

        <!-- Editor Panel -->
        <div class="panel editor-panel">
            <div class="tab-bar" id="tab-bar">
                <!-- JS Generated Tabs -->
            </div>
            <textarea id="code-editor" spellcheck="false">// Carregando sistema...</textarea>
            <div class="editor-controls">
                <button id="run-btn" class="btn btn-primary w-full">EXECUTAR</button>
            </div>
        </div>

        <!-- Game Viewport -->
        <div class="game-viewport">
            <div id="farm-grid">
                <div id="drone-el">
                    <div id="drone-visual"></div>
                </div>
                <!-- Tiles generated here -->
            </div>
        </div>
        
        <!-- Left Panel Wrapper -->
        <div class="panel status-panel p-4">
            <h2 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-3">Drone Status</h2>
            <div id="drone-status-content"></div>
            
            <div class="flex-grow flex flex-col mt-4 min-h-[100px] border-t border-gray-800 pt-4">
                <h2 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-2">Terminal</h2>
                <div id="console-output"></div>
            </div>
        </div>
    </div>

    <!-- Tech Modal -->
    <div id="tech-modal" class="modal-overlay hidden">
        <div class="modal-content max-w-5xl bg-[#18181b]">
            <div class="flex justify-between items-center p-6 border-b border-gray-800 modal-header">
                <div class="flex items-center gap-3">
                    <h2 class="text-2xl font-bold text-white tracking-tight">Loja de Upgrades</h2>
                    <span class="bg-accent-warning/20 text-accent-warning px-2 py-1 rounded text-[10px] font-bold uppercase tracking-wider">Mercado Negro</span>
                </div>
                <button id="close-modal-btn" class="text-gray-500 hover:text-white text-2xl transition-colors">&times;</button>
            </div>
            
            <div class="modal-scrollable">
                <div class="flex bg-[#09090b] border-b border-gray-800 overflow-x-auto tab-sticky">
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="land">Terreno</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="harvest">Colheita</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="speed">Velocidade</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="capacity">Carga</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="robotics">Rob√≥tica</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="seeds">Sementes</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="water">√Ågua</button>
                    <button class="tab-btn px-6 py-4 text-sm font-semibold text-gray-400 hover:text-white" data-tab="code">Sistema</button>
                </div>

                <div id="upgrades-list" class="p-6 space-y-4 bg-[#18181b]">
                    <!-- Dynamic Content -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bots Modal -->
    <div id="bots-modal" class="modal-overlay hidden">
        <div class="modal-content max-w-4xl bg-[#18181b]">
             <div class="flex justify-between items-center p-6 border-b border-gray-800 modal-header">
                <div class="flex items-center gap-4">
                    <h2 class="text-2xl font-bold text-white tracking-tight">F√°brica de Rob√¥s</h2>
                    <span id="bot-status-badge" class="text-xs px-2 py-1 rounded bg-green-900/50 text-green-400 font-mono tracking-wider font-bold uppercase transition-colors">ONLINE</span>
                </div>
                <button id="close-bots-btn" class="text-gray-500 hover:text-white text-2xl transition-colors">&times;</button>
            </div>
            
            <div class="modal-scrollable p-6">
                <!-- Controls -->
                <div class="flex gap-4 mb-6">
                    <button id="toggle-bots-btn" class="btn btn-primary flex-1">PAUSAR OPERA√á√ÉO</button>
                    <div class="bg-[#27272a] p-3 rounded flex-1 flex justify-between items-center border border-[#3f3f46]">
                         <span class="text-gray-400 text-sm">Capacidade do N√∫cleo</span>
                         <span id="bot-capacity-display" class="font-bold text-white font-mono">0 / 0</span>
                    </div>
                </div>

                <!-- Bot List/Grid -->
                <h3 class="text-md font-bold text-white mb-3">Rob√¥s Ativos</h3>
                <div id="active-bots-grid" class="grid grid-cols-4 gap-4 mb-8">
                     <!-- Dynamic -->
                </div>

                <!-- Shop -->
                <h3 class="text-md font-bold text-white mb-3">Linha de Montagem (Custo: 50 un.)</h3>
                <div id="bot-shop-grid" class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <!-- Dynamic -->
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal (Simplified) -->
    <div id="help-modal" class="modal-overlay hidden">
        <div class="modal-content p-6 max-w-4xl bg-[#18181b]">
             <div class="flex justify-between items-center mb-6 border-b border-gray-800 pb-4">
                <div class="flex items-center gap-3">
                   <h2 class="text-2xl font-bold text-white tracking-tight">API Reference</h2>
                   <span class="bg-accent-primary/20 text-accent-primary px-2 py-1 rounded text-xs font-bold uppercase tracking-wider">Docs</span>
                </div>
                <button id="close-help-modal-btn" class="text-2xl text-gray-500 hover:text-white transition-colors">&times;</button>
            </div>
            <div class="flex h-[500px] gap-6">
                <div id="function-list" class="w-1/3 bg-[#09090b] rounded-xl p-3 overflow-y-auto border border-gray-800/50 shadow-inner flex flex-col gap-1"></div>
                <div id="function-details" class="w-2/3 bg-transparent rounded-xl overflow-y-auto text-sm text-gray-300"></div>
            </div>
        </div>
    </div>
    </div>
    <!-- Delete Modal -->
    <div id="delete-modal" class="modal-overlay hidden">
        <div class="modal-content p-6 max-w-sm mx-auto mt-20 bg-[#18181b] border border-red-900/50 shadow-2xl rounded-xl">
            <h3 class="text-xl font-bold text-white uppercase text-center mb-4">Descartar Item</h3>
            
            <div class="flex flex-col items-center mb-6">
                <div id="delete-item-icon" class="text-6xl mb-2">üì¶</div>
                <span id="delete-item-name" class="text-lg font-bold text-gray-300 uppercase">ITEM NAME</span>
                <p class="text-xs text-gray-500 mt-1">Quanto deseja jogar fora?</p>
            </div>

            <div class="flex items-center gap-4 mb-8">
                <input type="range" id="delete-slider" min="1" max="100" value="1" class="w-full accent-red-500 cursor-pointer h-2 bg-gray-700 rounded-lg appearance-none">
                <input type="number" id="delete-input" min="1" max="100" value="1" class="w-16 bg-[#09090b] border border-[#3f3f46] rounded p-2 text-center text-white font-mono font-bold focus:border-red-500 outline-none">
            </div>

            <div class="flex gap-3">
                <button id="delete-cancel-btn" class="flex-1 py-3 rounded-lg bg-[#27272a] text-gray-400 hover:text-white hover:bg-[#3f3f46] font-bold transition-colors">CANCELAR</button>
                <button id="delete-confirm-btn" class="flex-1 py-3 rounded-lg bg-red-600 text-white hover:bg-red-500 font-bold transition-colors shadow-lg shadow-red-900/20">DESCARTAR</button>
            </div>
        </div>
    </div>

    <script type="module" src="./main.js"></script>
</body>
</html>
